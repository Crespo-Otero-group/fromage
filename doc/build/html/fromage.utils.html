

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.1.1.4. fromage.utils package &mdash; fromage 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="fromage 1.0 documentation" href="index.html"/>
        <link rel="up" title="5.1. fromage package" href="fromage.html"/>
        <link rel="prev" title="5.1.1.3. fromage.scripts package" href="fromage.scripts.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> fromage
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. Program overview and install</a></li>
<li class="toctree-l1"><a class="reference internal" href="gloss.html">2. Essential glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">3. Tutorial for geometry optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">4. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">5. Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="zrefs.html">6. References</a></li>
</ul>
<p class="caption"><span class="caption-text">Theoretical background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cluster_models.html">1. ONIOM cluster models</a></li>
<li class="toctree-l1"><a class="reference internal" href="ewald.html">2. Ewald point charge fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="penalty_func.html">3. Minimal Energy Conical Intersection optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pop.html">4. Population analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Program documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">1. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">2. Input file description</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_manipulation.html">3. Structure manipulation in fromage</a></li>
<li class="toctree-l1"><a class="reference internal" href="script.html">4. Miscellaneous scripts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">5. fromage API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="fromage.html">5.1. fromage package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="fromage.html#subpackages">5.1.1. Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="fromage.fdist.html">5.1.1.1. fromage.fdist package</a></li>
<li class="toctree-l4"><a class="reference internal" href="fromage.io.html">5.1.1.2. fromage.io package</a></li>
<li class="toctree-l4"><a class="reference internal" href="fromage.scripts.html">5.1.1.3. fromage.scripts package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">5.1.1.4. fromage.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fromage.html#module-fromage">5.1.2. Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fromage</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">5. fromage API</a> &raquo;</li>
        
          <li><a href="fromage.html">5.1. fromage package</a> &raquo;</li>
        
      <li>5.1.1.4. fromage.utils package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/fromage.utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fromage-utils-package">
<h1>5.1.1.4. fromage.utils package<a class="headerlink" href="#fromage-utils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>5.1.1.4.1. Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-fromage.utils.atom">
<span id="fromage-utils-atom-module"></span><h2>5.1.1.4.2. fromage.utils.atom module<a class="headerlink" href="#module-fromage.utils.atom" title="Permalink to this headline">¶</a></h2>
<p>Defines the Atom object</p>
<dl class="class">
<dt id="fromage.utils.atom.Atom">
<em class="property">class </em><code class="descclassname">fromage.utils.atom.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>elemIn='H'</em>, <em>xIn=0.0</em>, <em>yIn=0.0</em>, <em>zIn=0.0</em>, <em>qIn=0.0</em>, <em>num=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object representing an atom.</p>
<p>Sometimes also used to represent point charges as atoms of element “point”.
Several functions are present like translate or find_centroid.</p>
<dl class="attribute">
<dt>
<code class="descname">x,y,z</code></dt>
<dd><p><em>floats</em> – Cartesian coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.atom.Atom.q">
<code class="descname">q</code><a class="headerlink" href="#fromage.utils.atom.Atom.q" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em> – Partial atomic charge</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.atom.Atom.connectivity">
<code class="descname">connectivity</code><a class="headerlink" href="#fromage.utils.atom.Atom.connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p><em>frozenset of tuples</em> – The set is ((atom kind,connectivity order),amount) and is set via a
function which takes the connectivity matrix as argument</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.atom.Atom.kind">
<code class="descname">kind</code><a class="headerlink" href="#fromage.utils.atom.Atom.kind" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tuple</em> – Tuple of (atom element,connectivity). This defines the kind of atom</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.atom.Atom.total_e">
<code class="descname">total_e</code><a class="headerlink" href="#fromage.utils.atom.Atom.total_e" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – Atomic number</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.atom.Atom.valence">
<code class="descname">valence</code><a class="headerlink" href="#fromage.utils.atom.Atom.valence" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – Number of valence electrons</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.atom.Atom.vdw">
<code class="descname">vdw</code><a class="headerlink" href="#fromage.utils.atom.Atom.vdw" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em> – Van der Waals radius in Angstrom</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.atom.Atom.cov">
<code class="descname">cov</code><a class="headerlink" href="#fromage.utils.atom.Atom.cov" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em> – Covalent radius in Angstrom</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.at_lap">
<code class="descname">at_lap</code><span class="sig-paren">(</span><em>other_atom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.at_lap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.at_lap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the overlap between vdw radii</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.c_dist">
<code class="descname">c_dist</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>z1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.c_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.c_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distance of the atom from a point</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.c_dist2">
<code class="descname">c_dist2</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>z1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.c_dist2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.c_dist2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distance squared of the atom from a point</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.dist">
<code class="descname">dist</code><span class="sig-paren">(</span><em>other_atom</em>, <em>ref='dis'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distance between atoms starting form different ref points</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.dist_cov">
<code class="descname">dist_cov</code><span class="sig-paren">(</span><em>other_atom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.dist_cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.dist_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between covalent spheres of atoms</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.dist_dis">
<code class="descname">dist_dis</code><span class="sig-paren">(</span><em>other_atom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.dist_dis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.dist_dis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between centres of atoms</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.dist_lat">
<code class="descname">dist_lat</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>z1</em>, <em>aVec</em>, <em>bVec</em>, <em>cVec</em>, <em>order=1</em>, <em>ref='dis'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.dist_lat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.dist_lat" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the shortest distance to a point in a periodic system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x1,y1,z1</strong> (<em>floats</em>) – Cartesian coordinates of the target point</li>
<li><strong>aVec,bVec,cVec</strong> (<em>3x1 array-likes</em>) – Unit cell vectors</li>
<li><strong>order</strong> (<em>positive int</em>) – The amount of translations to be considered. Order 1 considers a
translation by -1, 0 and 1 of each lattice vector and all resulting
combination. Order 2 is [-2, -1, 0, 1, 2] and so onzx</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>rMin</strong> (<em>float</em>) – Minimal distance to the point</li>
<li><strong>x3,y3,z3</strong> (<em>floats</em>) – Coordinates of the closest image to the point</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.dist_vdw">
<code class="descname">dist_vdw</code><span class="sig-paren">(</span><em>other_atom</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.dist_vdw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.dist_vdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between vdw spheres of atoms</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.es_pot">
<code class="descname">es_pot</code><span class="sig-paren">(</span><em>position</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.es_pot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.es_pot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the electorstatic potential generated by this Atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>position</strong> (<em>3x1 np array</em>) – The point at which the potential should be evaluated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>pot</strong> – The potential of the Atom felt at the input position</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.get_pos">
<code class="descname">get_pos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.get_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.get_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return np array of coord</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.per_dist">
<code class="descname">per_dist</code><span class="sig-paren">(</span><em>other_atom</em>, <em>vectors</em>, <em>ref='dis'</em>, <em>new_pos=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.per_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.per_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the shortest distance to another atom in a periodic system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>other_atom</strong> (<em>Atom object</em>) – The atom which to which the distance is being calculated</li>
<li><strong>vectors</strong> (<em>3 x 3 numpy array</em>) – Unit cell vectors</li>
<li><strong>order</strong> (<em>positive int</em>) – The amount of translations to be considered. Order 1 considers a
translation by -1, 0 and 1 of each lattice vector and all resulting
combination. Order 2 is [-2, -1, 0, 1, 2] and so onzx</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>r_min</strong> (<em>float</em>) – Minimal distance to the point</li>
<li><strong>at_img</strong> (<em>floats (optional)</em>) – Closest image of the atom being targeted</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.put_in_cell">
<code class="descname">put_in_cell</code><span class="sig-paren">(</span><em>vectors</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.put_in_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.put_in_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new atom at a position inside the parallelepiped cell</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.set_connectivity">
<code class="descname">set_connectivity</code><span class="sig-paren">(</span><em>in_atoms</em>, <em>in_row</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.set_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.set_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the connectivity and the kind of the atom.</p>
<p>This function needs a row of a connectivity matrix which can be obtained
with functions from assign_charges.py</p>
<p>Check the constructor at the top of this file for more info on connectivity
and kind.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_atoms</strong> (<em>list of atoms</em>) – Atoms in the system of which this atom is a part</li>
<li><strong>in_row</strong> (<em>1-d array-like</em>) – The row of the connectivity matrix of in_atoms which corresponds to
this atom</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.set_pos">
<code class="descname">set_pos</code><span class="sig-paren">(</span><em>pos_array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.set_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.set_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign coordinates via numpy array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pos_array</strong> (<em>3 x 1 list-like</em>) – The position to assign to the atom</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>z1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the atom by some vector.</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.translated">
<code class="descname">translated</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>z1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.translated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.translated" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new atom which is a translated copy.</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.v_dist">
<code class="descname">v_dist</code><span class="sig-paren">(</span><em>position</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.v_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.v_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distance of the atom from a point defined by an array-like</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.v_dist2">
<code class="descname">v_dist2</code><span class="sig-paren">(</span><em>position</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.v_dist2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.v_dist2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distance of the atom from a point defined by an array-like</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.v_translate">
<code class="descname">v_translate</code><span class="sig-paren">(</span><em>vec_trans</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.v_translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.v_translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the atom by some vector.</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.v_translated">
<code class="descname">v_translated</code><span class="sig-paren">(</span><em>vec_trans</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.v_translated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.v_translated" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new atom which is a translated copy.</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.very_close">
<code class="descname">very_close</code><span class="sig-paren">(</span><em>other</em>, <em>thresh=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.very_close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.very_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if two atoms are very close together</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.atom.Atom.xyz_str">
<code class="descname">xyz_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/atom.html#Atom.xyz_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.atom.Atom.xyz_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string of the atom in xyz format</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fromage.utils.calc">
<span id="fromage-utils-calc-module"></span><h2>5.1.1.4.3. fromage.utils.calc module<a class="headerlink" href="#module-fromage.utils.calc" title="Permalink to this headline">¶</a></h2>
<p>Defines the Calc objects which are used to run calculations</p>
<p>The purpose of the concrete classes is to handle all of the specificities of
each program so as to be able to call a calculation and read its output in
the same way from the main program regardless of which program it is.</p>
<p>As such if any clunky code is necessary due to an external program’s specific
preferences, it should be contained here in its Calc object member methods.</p>
<dl class="class">
<dt id="fromage.utils.calc.Calc">
<em class="property">class </em><code class="descclassname">fromage.utils.calc.</code><code class="descname">Calc</code><span class="sig-paren">(</span><em>calc_name_in=None</em>, <em>in_here='/home/miguel/Scripts/fromage/doc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract class for calculation objects</p>
<dl class="attribute">
<dt id="fromage.utils.calc.Calc.calc_name">
<code class="descname">calc_name</code><a class="headerlink" href="#fromage.utils.calc.Calc.calc_name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – Name of the calculation, typically rl, ml, mh or mg</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Calc.read_out">
<code class="descname">read_out</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol=None</em>, <em>in_shell=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Calc.read_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Calc.read_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the output of the calculation and sometimes updates the geom_*.xyz files</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Calc.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Calc.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Calc.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write all of the variable inputs necessary for one calculations</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Calc.update_geom">
<code class="descname">update_geom</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol</em>, <em>in_shell</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Calc.update_geom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Calc.update_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the geom_mol.xyz and geom_cluster.xyz files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>positions</strong> (<em>list of floats</em>) – List of atomic coordinates</li>
<li><strong>in_mol</strong> (<em>list of Atom objects</em>) – Atoms in the inner region</li>
<li><strong>in_shell</strong> (<em>list of Atom objects</em>) – Atoms in the middle region</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fromage.utils.calc.DFTB_calc">
<em class="property">class </em><code class="descclassname">fromage.utils.calc.</code><code class="descname">DFTB_calc</code><span class="sig-paren">(</span><em>calc_name_in=None</em>, <em>in_here='/home/miguel/Scripts/fromage/doc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#DFTB_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.DFTB_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fromage.utils.calc.Calc" title="fromage.utils.calc.Calc"><code class="xref py py-class docutils literal notranslate"><span class="pre">fromage.utils.calc.Calc</span></code></a></p>
<p>Calculation of DFTB+ tested with v18.2</p>
<dl class="method">
<dt id="fromage.utils.calc.DFTB_calc.read_out">
<code class="descname">read_out</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol=None</em>, <em>in_shell=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#DFTB_calc.read_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.DFTB_calc.read_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse a DFTB+ detailed.out file while printing geometry updates</p>
<p>To update the geom files, include in_mol and in_shell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>list of floats</em>) – List of atomic coordinates, important for truncation of gradients
if too many are calculated</li>
<li><strong>in_mol</strong> (<em>list of Atom objects, optional</em>) – Atoms in the inner region. Include to write geom files</li>
<li><strong>in_shell</strong> (<em>list of Atom objects, optional</em>) – Atoms in the middle region. Include to write geom files</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>energy</strong> (<em>float</em>) – Energy calculated by DFTB+ in Hartree</li>
<li><strong>gradients</strong> (<em>list of floats</em>) – The gradients in form x1,y1,z1,x2,y2,z2 etc. in Hartree/Angstrom</li>
<li><strong>scf_energy</strong> (<em>float</em>) – The ground state energy in Hartree</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.DFTB_calc.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#DFTB_calc.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.DFTB_calc.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a DFTB .gen file and return a subprocess.Popen</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> (<em>list of Atom objects</em>) – Atoms to be calculated with DFTB+</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>proc</strong> – the object should have a .wait() method</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">subprocess.Popen object</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fromage.utils.calc.Gauss_CAS_calc">
<em class="property">class </em><code class="descclassname">fromage.utils.calc.</code><code class="descname">Gauss_CAS_calc</code><span class="sig-paren">(</span><em>calc_name_in=None</em>, <em>in_here='/home/miguel/Scripts/fromage/doc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Gauss_CAS_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Gauss_CAS_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fromage.utils.calc.Calc" title="fromage.utils.calc.Calc"><code class="xref py py-class docutils literal notranslate"><span class="pre">fromage.utils.calc.Calc</span></code></a></p>
<p>Calculation with Gaussian 09 for CAS calculations</p>
<dl class="method">
<dt id="fromage.utils.calc.Gauss_CAS_calc.read_out">
<code class="descname">read_out</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol=None</em>, <em>in_shell=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Gauss_CAS_calc.read_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Gauss_CAS_calc.read_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse a Gaussian .chk file while printing geometry updates</p>
<p>To update the geom files, include in_mol and in_shell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>list of floats</em>) – List of atomic coordinates, important for truncation of gradients
if too many are calculated</li>
<li><strong>in_mol</strong> (<em>list of Atom objects, optional</em>) – Atoms in the inner region</li>
<li><strong>in_shell</strong> (<em>list of Atom objects, optional</em>) – Atoms in the middle region</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>energy</strong> (<em>float</em>) – Energy calculated by Gaussian in Hartree</li>
<li><strong>gradients</strong> (<em>list of floats</em>) – The gradients in form x1,y1,z1,x2,y2,z2 etc. in Hartree/Angstrom</li>
<li><strong>scf_energy</strong> (<em>float</em>) – The ground state energy in Hartree</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Gauss_CAS_calc.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Gauss_CAS_calc.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Gauss_CAS_calc.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a Gaussian input file and return a subprocess.Popen</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> (<em>list of Atom objects</em>) – Atoms to be calculated with Gaussian</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>proc</strong> – the object should have a .wait() method</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">subprocess.Popen object</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fromage.utils.calc.Gauss_calc">
<em class="property">class </em><code class="descclassname">fromage.utils.calc.</code><code class="descname">Gauss_calc</code><span class="sig-paren">(</span><em>calc_name_in=None</em>, <em>in_here='/home/miguel/Scripts/fromage/doc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Gauss_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Gauss_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fromage.utils.calc.Calc" title="fromage.utils.calc.Calc"><code class="xref py py-class docutils literal notranslate"><span class="pre">fromage.utils.calc.Calc</span></code></a></p>
<p>Calculation with Gaussian 09</p>
<dl class="method">
<dt id="fromage.utils.calc.Gauss_calc.read_out">
<code class="descname">read_out</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol=None</em>, <em>in_shell=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Gauss_calc.read_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Gauss_calc.read_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse a Gaussian .chk file while printing geometry updates</p>
<p>To update the geom files, include in_mol and in_shell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>list of floats</em>) – List of atomic coordinates, important for truncation of gradients
if too many are calculated</li>
<li><strong>in_mol</strong> (<em>list of Atom objects, optional</em>) – Atoms in the inner region</li>
<li><strong>in_shell</strong> (<em>list of Atom objects, optional</em>) – Atoms in the middle region</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>energy</strong> (<em>float</em>) – Energy calculated by Gaussian in Hartree</li>
<li><strong>gradients</strong> (<em>list of floats</em>) – The gradients in form x1,y1,z1,x2,y2,z2 etc. in Hartree/Angstrom</li>
<li><strong>scf_energy</strong> (<em>float</em>) – The ground state energy in Hartree</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Gauss_calc.read_out_mol">
<code class="descname">read_out_mol</code><span class="sig-paren">(</span><em>pop='EPS'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Gauss_calc.read_out_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Gauss_calc.read_out_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the output log file and return Mol</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Gauss_calc.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Gauss_calc.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Gauss_calc.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a Gaussian input file and return a subprocess.Popen</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> (<em>list of Atom objects</em>) – Atoms to be calculated with Gaussian</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>proc</strong> – the object should have a .wait() method</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">subprocess.Popen object</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fromage.utils.calc.Molcas_calc">
<em class="property">class </em><code class="descclassname">fromage.utils.calc.</code><code class="descname">Molcas_calc</code><span class="sig-paren">(</span><em>calc_name_in=None</em>, <em>in_here='/home/miguel/Scripts/fromage/doc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Molcas_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Molcas_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fromage.utils.calc.Calc" title="fromage.utils.calc.Calc"><code class="xref py py-class docutils literal notranslate"><span class="pre">fromage.utils.calc.Calc</span></code></a></p>
<p>Calculation with Molcas 8.0</p>
<dl class="method">
<dt id="fromage.utils.calc.Molcas_calc.read_out">
<code class="descname">read_out</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol=None</em>, <em>in_shell=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Molcas_calc.read_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Molcas_calc.read_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse a Molcas .input file while printing geometry updates</p>
<p>To update the geom files, include in_mol and in_shell. Also removes
molcas.*</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>list of floats</em>) – List of atomic coordinates, important for truncation of gradients
if too many are calculated</li>
<li><strong>in_mol</strong> (<em>list of Atom objects, optional</em>) – Atoms in the inner region. Include to write geom files</li>
<li><strong>in_shell</strong> (<em>list of Atom objects, optional</em>) – Atoms in the middle region. Include to write geom files</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>energy</strong> (<em>float</em>) – Energy calculated by Gaussian in Hartree</li>
<li><strong>gradients</strong> (<em>list of floats</em>) – The gradients in form x1,y1,z1,x2,y2,z2 etc. in Hartree/Angstrom</li>
<li><strong>scf_energy</strong> (<em>float</em>) – The ground state energy in Hartree</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Molcas_calc.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Molcas_calc.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Molcas_calc.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a Molcas input file and return a subprocess.Popen</p>
<p>Make sure the input file is called [name of calculation].input
e.g. mh.input and the geometry file in Gateway is called geom.xyz</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> (<em>list of Atom objects</em>) – Atoms to be calculated with Gaussian</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>proc</strong> – the object should have a .wait() method</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">subprocess.Popen object</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fromage.utils.calc.Turbo_SCF_calc">
<em class="property">class </em><code class="descclassname">fromage.utils.calc.</code><code class="descname">Turbo_SCF_calc</code><span class="sig-paren">(</span><em>calc_name_in=None</em>, <em>in_here='/home/miguel/Scripts/fromage/doc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Turbo_SCF_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Turbo_SCF_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fromage.utils.calc.Calc" title="fromage.utils.calc.Calc"><code class="xref py py-class docutils literal notranslate"><span class="pre">fromage.utils.calc.Calc</span></code></a></p>
<p>Calculation of SCF like DFT or HF with Turbomole 7.0</p>
<dl class="method">
<dt id="fromage.utils.calc.Turbo_SCF_calc.read_out">
<code class="descname">read_out</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol=None</em>, <em>in_shell=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Turbo_SCF_calc.read_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Turbo_SCF_calc.read_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse a Turbomole gradient file while printing geometry updates</p>
<p>To update the geom files, include in_mol and in_shell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>list of floats</em>) – List of atomic coordinates, important for truncation of gradients
if too many are calculated</li>
<li><strong>in_mol</strong> (<em>list of Atom objects, optional</em>) – Atoms in the inner region. Include to write geom files</li>
<li><strong>in_shell</strong> (<em>list of Atom objects, optional</em>) – Atoms in the middle region. Include to write geom files</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>energy</strong> (<em>float</em>) – Energy calculated by Gaussian in Hartree</li>
<li><strong>gradients</strong> (<em>list of floats</em>) – The gradients in form x1,y1,z1,x2,y2,z2 etc. in Hartree/Angstrom</li>
<li><strong>scf_energy</strong> (<em>float</em>) – The ground state energy in Hartree</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Turbo_SCF_calc.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Turbo_SCF_calc.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Turbo_SCF_calc.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a Turbomole coord file and return a subprocess.Popen</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> (<em>list of Atom objects</em>) – Atoms to be calculated with Gaussian</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>proc</strong> – the object should have a .wait() method</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">subprocess.Popen object</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fromage.utils.calc.Turbo_calc">
<em class="property">class </em><code class="descclassname">fromage.utils.calc.</code><code class="descname">Turbo_calc</code><span class="sig-paren">(</span><em>calc_name_in=None</em>, <em>in_here='/home/miguel/Scripts/fromage/doc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Turbo_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Turbo_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fromage.utils.calc.Calc" title="fromage.utils.calc.Calc"><code class="xref py py-class docutils literal notranslate"><span class="pre">fromage.utils.calc.Calc</span></code></a></p>
<p>Calculation of CC2 with Turbomole 7.0</p>
<dl class="method">
<dt id="fromage.utils.calc.Turbo_calc.read_out">
<code class="descname">read_out</code><span class="sig-paren">(</span><em>positions</em>, <em>in_mol=None</em>, <em>in_shell=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Turbo_calc.read_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Turbo_calc.read_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyse a Turbomole ricc2.out file while printing geometry updates</p>
<p>To update the geom files, include in_mol and in_shell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>list of floats</em>) – List of atomic coordinates, important for truncation of gradients
if too many are calculated</li>
<li><strong>in_mol</strong> (<em>list of Atom objects, optional</em>) – Atoms in the inner region. Include to write geom files</li>
<li><strong>in_shell</strong> (<em>list of Atom objects, optional</em>) – Atoms in the middle region. Include to write geom files</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>energy</strong> (<em>float</em>) – Energy calculated by Turbomole in Hartree</li>
<li><strong>gradients</strong> (<em>list of floats</em>) – The gradients in form x1,y1,z1,x2,y2,z2 etc. in Hartree/Angstrom</li>
<li><strong>scf_energy</strong> (<em>float</em>) – The ground state energy in Hartree</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.calc.Turbo_calc.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#Turbo_calc.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.Turbo_calc.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a Turbomole coord file and return a subprocess.Popen</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> (<em>list of Atom objects</em>) – Atoms to be calculated with Gaussian</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>proc</strong> – the object should have a .wait() method</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">subprocess.Popen object</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="fromage.utils.calc.setup_calc">
<code class="descclassname">fromage.utils.calc.</code><code class="descname">setup_calc</code><span class="sig-paren">(</span><em>calc_name</em>, <em>calc_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#setup_calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.setup_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a calculation of the correct subclass</p>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.calc.turbo_redefine">
<code class="descclassname">fromage.utils.calc.</code><code class="descname">turbo_redefine</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/calc.html#turbo_redefine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.calc.turbo_redefine" title="Permalink to this definition">¶</a></dt>
<dd><p>Update Turbomole mos and run actual</p>
</dd></dl>

</div>
<div class="section" id="module-fromage.utils.fit">
<span id="fromage-utils-fit-module"></span><h2>5.1.1.4.4. fromage.utils.fit module<a class="headerlink" href="#module-fromage.utils.fit" title="Permalink to this headline">¶</a></h2>
<p>Fit point charges to match a given potential</p>
<dl class="function">
<dt id="fromage.utils.fit.alt_shell_region">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">alt_shell_region</code><span class="sig-paren">(</span><em>in_grid</em>, <em>sample_atoms</em>, <em>inner_r</em>, <em>outer_r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#alt_shell_region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.alt_shell_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Return grid points in shell regions around given points</p>
<p>The shell region is determined by inner and outer radii which are then
scaled by the wdv radii of the corresponding atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_grid</strong> (<em>numpy array of N x 4</em>) – A real space grid representing a field with each row being
[x y z value]</li>
<li><strong>sample_atoms</strong> (<em>Mol object</em>) – The atoms which are to be enclosed by the shells</li>
<li><strong>inner_r</strong> (<em>float</em>) – The inner radius of the shell before wdv scaling</li>
<li><strong>outer_r</strong> (<em>float</em>) – The outer radius of the shell before scaling</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>shell_points</strong> – The sampling points with rows as x1 y1 z1 value1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy N x 4 array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.fit.coeff_mat">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">coeff_mat</code><span class="sig-paren">(</span><em>var_points</em>, <em>samples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#coeff_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.coeff_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coefficients matrix</p>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.fit.coeff_row">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">coeff_row</code><span class="sig-paren">(</span><em>var_points</em>, <em>sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#coeff_row"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.coeff_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Return row of the coefficients matrix</p>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.fit.dep_var">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">dep_var</code><span class="sig-paren">(</span><em>var_points</em>, <em>fix_points</em>, <em>samples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#dep_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.dep_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dependent variable array</p>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.fit.fit_clust">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">fit_clust</code><span class="sig-paren">(</span><em>in_cell</em>, <em>in_labels</em>, <em>in_cube</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#fit_clust"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.fit_clust" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="fromage.utils.fit.fit_points">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">fit_points</code><span class="sig-paren">(</span><em>var_points</em>, <em>samples</em>, <em>fix_points=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#fit_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.fit_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new set of point charges that matches the potential at points</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>var_points</strong> (<em>Mol object</em>) – Point charges to be fitted</li>
<li><strong>samples</strong> (<em>list of Mol objects or just one Mol object</em>) – Sampling points each with an associated electrostatic potential</li>
<li><strong>fix_points</strong> (<em>Mol object</em>) – Point charges to remain in place</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_points</strong> – The points at their same position but with optimised charge value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Mol object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.fit.shell_region">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">shell_region</code><span class="sig-paren">(</span><em>in_grid</em>, <em>sample_atoms</em>, <em>inner_r</em>, <em>outer_r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#shell_region"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.shell_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Return grid points in shell regions around given points</p>
<p>The shell region is determined by inner and outer radii which are then
scaled by the wdv radii of the corresponding atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_grid</strong> (<em>numpy array of N x 4</em>) – A real space grid representing a field with each row being
[x y z value]</li>
<li><strong>sample_atoms</strong> (<em>Mol object</em>) – The atoms which are to be enclosed by the shells</li>
<li><strong>inner_r</strong> (<em>float</em>) – The inner radius of the shell before wdv scaling</li>
<li><strong>outer_r</strong> (<em>float</em>) – The outer radius of the shell before scaling</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>shell_points</strong> – The sampling points with rows as x1 y1 z1 value1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy N x 4 array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.fit.shells_from_cell">
<code class="descclassname">fromage.utils.fit.</code><code class="descname">shells_from_cell</code><span class="sig-paren">(</span><em>cell_cub</em>, <em>central_mol</em>, <em>trans_vec</em>, <em>inner_r</em>, <em>outer_r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/fit.html#shells_from_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.fit.shells_from_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the points in shell regions of a cube file after translation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cell_cub</strong> (<em>CubeGrid object</em>) – The cube file of the unit cell before any translations</li>
<li><strong>central_mol</strong> (<em>Mol object</em>) – The atoms which need to be surrounded by shells. These have already been
selected from lattice positions and translated by trans_vec</li>
<li><strong>trans_vec</strong> (<em>3x1 numpy object</em>) – Vector by which cental_mol was translated and which therefore needs to
translate the cell_cub.grid</li>
<li><strong>inner_r</strong> (<em>float</em>) – The inner radius of the shell region for sampling around atoms of the
central_mol. This distance is then scaled by wdv radius</li>
<li><strong>outer_r</strong> (<em>float</em>) – The outer radius of the shell region for sampling around atoms of the
central_mol. This distance is then scaled by wdv radius</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>shell_points</strong> – The sampling points with rows as x1 y1 z1 value1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy Nx4 array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-fromage.utils.handle_atoms">
<span id="fromage-utils-handle-atoms-module"></span><h2>5.1.1.4.5. fromage.utils.handle_atoms module<a class="headerlink" href="#module-fromage.utils.handle_atoms" title="Permalink to this headline">¶</a></h2>
<p>Some functions to handle lists of atoms</p>
<dl class="function">
<dt id="fromage.utils.handle_atoms.array2atom">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">array2atom</code><span class="sig-paren">(</span><em>template</em>, <em>pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#array2atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.array2atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn an array of the form x1, y1, z1, x2, y2, z2 etc. into a list of Atom
objects</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>template</strong> (<em>list of Atom objects</em>) – A list of the same length of the desired one used to determine the
elements of the atoms</li>
<li><strong>pos</strong> (<em>list of floats</em>) – List of coordinates of the form x1, y1, z1, x2, y2, z2 etc.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out_atoms</strong> – Resulting atoms</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of Atom objects</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.center_mol">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">center_mol</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#center_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.center_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate molecules to center</p>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.complete_cell">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">complete_cell</code><span class="sig-paren">(</span><em>atoms</em>, <em>vectors</em>, <em>max_bl=1.7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#complete_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.complete_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a cell where atoms have been translated to complete all molecules of
the cell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – The input truncated unit cell</li>
<li><strong>vectors</strong> (<em>3 x 3 numpy array</em>) – The unit cell vectors</li>
<li><strong>max_bl</strong> (<em>float</em>) – The maximum interatomic distance which is considered a bond</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>out_cell</strong> (<em>list of Atom objects</em>) – The new untruncated cell</li>
<li><strong>full_mol_l</strong> (<em>list of lists of Atom objects</em>) – Each molecule in the untruncated cell</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.complete_mol">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">complete_mol</code><span class="sig-paren">(</span><em>max_r</em>, <em>atoms</em>, <em>label</em>, <em>vectors</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#complete_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.complete_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a cell and complete one molecule.</p>
<p>The objective is to end up with a unit cell where the molecule of interest
is complete. The rest of the atoms of the cell can remain intact. Note that
the input atoms are transformed and are the same as are present in the
output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_r</strong> (<em>float</em>) – Maximum distance which is considered a bond</li>
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – Cluster of atoms which from which a molecule needs to be extracted</li>
<li><strong>label</strong> (<em>list of ints</em>) – The number of the atom from which the molecule is generated. Note that
it is the Python label, so starting from 0, unlike the label in most
chemistry software which counts from 1</li>
<li><strong>vectors</strong> (<em>3x3 matrix</em>) – Lattice vectors</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>full_mol_trans</strong> (<em>list of Atom objects</em>) – The now complete molecule</li>
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – The cell with the completed molecule. NB the Atom objects of the completed molecule
reference the same objects as full_mol_trans</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.find_centroid">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">find_centroid</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#find_centroid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.find_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the centroid of a list of atoms.</p>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.make_cluster">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">make_cluster</code><span class="sig-paren">(</span><em>atoms</em>, <em>clust_rad</em>, <em>max_bl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#make_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.make_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a cluster of molecules from a cluster of atoms.</p>
<p>Make sure the input cluster of atoms is large enough to contain the
desired cluster of molecules. You can generate a large cluster of atoms with
make_mega_cell. The molecules are defined as any with atoms falling within
a certain radius of the origin.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – A large cluster of atoms</li>
<li><strong>clust_rad</strong> (<em>float</em>) – Radius determining the initial atoms of the cluster of molecules. These
atoms are then the seed for full molecules</li>
<li><strong>max_bl</strong> (<em>float</em>) – Maximum distance which counts as a bond</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>clust_atoms</strong> – A list of atoms which form a cluster of molecules</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of Atom objects</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.make_mega_cell">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">make_mega_cell</code><span class="sig-paren">(</span><em>atoms</em>, <em>traAN</em>, <em>traBN</em>, <em>traCN</em>, <em>vectors</em>, <em>alt_multi=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#make_mega_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.make_mega_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a bigger supercell out of an input cell.</p>
<p>The cell is multiplied positively and negatively through each lattice
vector so that the supercluster ends up being
(1+2*traAN)*(1+2*traBN)*(1+2*traCN) times larger. For example if the
input is 1,1,1 for a cubic unit cell, the output will be the original unit
cell surrounded by 26 other unit cells forming a total 3x3x3 cube.</p>
<p>Alternatively, the multiplication can be centered around a corner of the
unit cell instead of the centre. In that case the supercluster ends up being
only (2*traAN)*(2*traBN)*(2*traCN)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – Atoms in the cell</li>
<li><strong>traAN,traBN,traCN</strong> (<em>ints</em>) – Number of times the cell should be multiplied in each cell direction,
positively and negatively</li>
<li><strong>vectors</strong> (<em>3x3 matrix</em>) – Lattice vectors</li>
<li><strong>alt_multi</strong> (<em>bool</em>) – Determines the kind of multiplication. True is centre of the cell as
the origin, False is corner of the cell.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mega_cell</strong> – The resulting supercell</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of Atom objects</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.make_molecules">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">make_molecules</code><span class="sig-paren">(</span><em>atoms</em>, <em>bl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#make_molecules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.make_molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate list of molecules based on bond length bl</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<em>list of Atom objects</em>)</li>
<li><strong>bl</strong> (<em>float</em>) – Bond length in unit of input file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>molecules</strong> – List L of length M molecules, where each member of L is a list of atom objects</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of lists</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.multi_select">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">multi_select</code><span class="sig-paren">(</span><em>max_r</em>, <em>atoms</em>, <em>labels</em>, <em>vectors</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#multi_select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.multi_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Select multiple molecules in a periodic system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_r</strong> (<em>float</em>) – Maximum distance which is considered a bond</li>
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – Cluster of atoms which from which molecules needs to be extracted</li>
<li><strong>labels</strong> (<em>list of ints</em>) – The numbers of the atom from which the molecules are generated. Note
that it is the Python label, so starting from 0, unlike the label in
most chemistry software which counts from 1</li>
<li><strong>vectors</strong> (<em>3x3 matrix</em>) – Lattice vectors</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>selected</strong> (<em>list of Atom objects</em>) – The atoms belonging to the molecules which are selected</li>
<li><strong>selected_img</strong> (<em>list of Atom objects</em>) – The atoms belonging to the molecules which are selected with certain
atoms translated so that the molecules are fully connected without
periodic boundaries</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.select">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">select</code><span class="sig-paren">(</span><em>max_r</em>, <em>atoms</em>, <em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.select" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a molecule out of a list of atoms.</p>
<p>The function puts a labelled atom in a list of selected atoms. It then
checks for nearby atoms to the selected atoms. If any are found and are not
already selected, they are added to the list. The loop ends when it is
executed and not atoms are added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_r</strong> (<em>float</em>) – Maximum distance which is considered a bond</li>
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – Cluster of atoms which from which a molecule needs to be extracted</li>
<li><strong>label</strong> (<em>int</em>) – The number of the atom from which the molecule is generated. Note that
it is the Python label, so starting from 0, unlike the label in most
chemistry software which counts from 1</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>selected</strong> – The atoms belonging to the molecule which is selected</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of Atom objects</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.select_per">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">select_per</code><span class="sig-paren">(</span><em>max_r</em>, <em>atoms</em>, <em>label</em>, <em>vectors</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#select_per"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.select_per" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a molecule out of a list of atoms in a periodic system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_r</strong> (<em>float</em>) – Maximum distance which is considered a bond</li>
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – Cluster of atoms which from which a molecule needs to be extracted</li>
<li><strong>label</strong> (<em>int</em>) – The number of the atom from which the molecule is generated. Note that
it is the Python label, so starting from 0, unlike the label in most
chemistry software which counts from 1</li>
<li><strong>vectors</strong> (<em>3x3 matrix</em>) – Lattice vectors</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>selected</strong> (<em>list of Atom objects</em>) – The atoms belonging to the molecule which is selected</li>
<li><strong>selected_img</strong> (<em>list of Atom objects</em>) – The atoms belonging to the molecule which is selected with certain
atoms translated so that the molecule is fully connected without
periodic boundaries</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.supercell">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">supercell</code><span class="sig-paren">(</span><em>atoms</em>, <em>vectors</em>, <em>trans</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#supercell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a supercell of I x J x K</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – Input cell atoms</li>
<li><strong>vectors</strong> (<em>3 x 3 numpy array</em>) – Lattice vectors</li>
<li><strong>trans</strong> (<em>numpy array of length 3</em>) – Multiplications of the primitive cell</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>supercell</strong> (<em>list of Atom objects</em>) – New supercell of Atoms</li>
<li><strong>out_vec</strong> (<em>3 x 3 numpy array</em>) – The lattice vectors of the new cell</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fromage.utils.handle_atoms.translate_atoms">
<code class="descclassname">fromage.utils.handle_atoms.</code><code class="descname">translate_atoms</code><span class="sig-paren">(</span><em>atoms</em>, <em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/handle_atoms.html#translate_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.handle_atoms.translate_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate some atoms by a vector</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atoms</strong> (<em>list of Atom objects</em>) – Untranslated atoms</li>
<li><strong>vector</strong> (<em>3 x 1 numpy array</em>) – Translation vector</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-fromage.utils.mol">
<span id="fromage-utils-mol-module"></span><h2>5.1.1.4.6. fromage.utils.mol module<a class="headerlink" href="#module-fromage.utils.mol" title="Permalink to this headline">¶</a></h2>
<p>The class used to manipulate lists of Atoms</p>
<dl class="class">
<dt id="fromage.utils.mol.Mol">
<em class="property">class </em><code class="descclassname">fromage.utils.mol.</code><code class="descname">Mol</code><span class="sig-paren">(</span><em>in_atoms=[], vectors=array([[0., 0., 0.],        [0., 0., 0.],        [0., 0., 0.]]), bonding='dis', thresh=1.8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object representing a list of atoms.</p>
<p>This class can be used to reflect any number of molecules, point charges or
unit cells. Although Mol shares many methods with list, it deliberately does
not inherit it in order to avoid nonsensical operations such as Mol1 &gt; Mol2</p>
<dl class="attribute">
<dt id="fromage.utils.mol.Mol.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#fromage.utils.mol.Mol.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of Atom objects</em> – Member atoms of Mol</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.mol.Mol.vectors">
<code class="descname">vectors</code><a class="headerlink" href="#fromage.utils.mol.Mol.vectors" title="Permalink to this definition">¶</a></dt>
<dd><p><em>3 x 3 numpy array</em> – Lattice vectors of the unit cell</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.mol.Mol.bonding">
<code class="descname">bonding</code><a class="headerlink" href="#fromage.utils.mol.Mol.bonding" title="Permalink to this definition">¶</a></dt>
<dd><p><em>string ‘dist, ‘cov’ or ‘vdw’</em> – The method for detecting bonding in this molecule.
‘dis’ : distance between atoms &lt; threshold
‘cov’ : distance - (cov radius of atom a + of atom b) &lt; threshold
‘vdw’ : distance - (vwd radius of atom a + of atom b) &lt; threshold</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.mol.Mol.thresh">
<code class="descname">thresh</code><a class="headerlink" href="#fromage.utils.mol.Mol.thresh" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float, optional</em> – Threshold for the detection. If None, use defaults</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.bonded">
<code class="descname">bonded</code><span class="sig-paren">(</span><em>atom_a</em>, <em>atom_b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.bonded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.bonded" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if atom_a is bonded to atom_b given the bonding settings</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_a, atom_b</strong> (<em>Atom objects</em>) – The atoms to be compared</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>bonded_bool</strong> – True if the atoms are bonded and False if not</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.center_mol">
<code class="descname">center_mol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.center_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.center_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate molecules to center</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.centered_mols">
<code class="descname">centered_mols</code><span class="sig-paren">(</span><em>labels</em>, <em>return_trans=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.centered_mols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.centered_mols" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the molecules translated at the origin with a corresponding cell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>labels</strong> (<em>int or list of ints</em>) – The labels of the atoms to select</li>
<li><strong>print_centro</strong> (<em>bool</em>) – Print the translation vector which was detected as -centroid</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>mol</strong> (<em>Mol object</em>) – The selected molecules with their centroid at the origin</li>
<li><strong>mod_cell</strong> (<em>Mol object</em>) – The new confined cell corresponding to the now translated molecules</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.centered_supercell">
<code class="descname">centered_supercell</code><span class="sig-paren">(</span><em>trans</em>, <em>from_origin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.centered_supercell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.centered_supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a bigger supercell out of an input cell.</p>
<p>The cell is multiplied positively and negatively through each lattice
vector so that the supercluster ends up being
(1+2*trans[0])*(1+2*trans[1])*(1+2*trans[2]) times larger. For example if the
input is 1,1,1 for a cubic unit cell, the output will be the original unit
cell surrounded by 26 other unit cells forming a total 3x3x3 cube.</p>
<p>Alternatively, the multiplication can be centered around the origin, a corner of the
unit cell, instead of the centre. In that case the supercluster ends up being
only (2*trans[0])*(2*trans[1])*(2*trans[2])</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>trans</strong> (<em>numpy array of length 3</em>) – Multiplications of the primitive cell</li>
<li><strong>from_origin</strong> (<em>bool</em>) – Determines the kind of multiplication. True is corner of the cell as
the center, False is middle of the cell.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mega_cell</strong> – The resulting supercell</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Mol object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.centroid">
<code class="descname">centroid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.centroid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return np array of the centroid</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.change_charges">
<code class="descname">change_charges</code><span class="sig-paren">(</span><em>charges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.change_charges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.change_charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Change all of the charges of the constituent atoms at once</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>charges</strong> (<em>array-like of floats</em>) – Contains all of the new charges. IMPORTANT: they need to be in the
order corresponding to self.atoms</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.charges">
<code class="descname">charges</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.charges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of charges</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.complete_cell">
<code class="descname">complete_cell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.complete_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.complete_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a cell where atoms have been translated to complete all molecules of
the cell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>out_cell</strong> (<em>Mol object</em>) – The new untruncated cell</li>
<li><strong>full_mol_l</strong> (<em>list of Mol objects</em>) – Each molecule in the untruncated cell</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.complete_mol">
<code class="descname">complete_mol</code><span class="sig-paren">(</span><em>labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.complete_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.complete_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a cell and complete certain molecules</p>
<p>The objective is to end up with a unit cell where the molecules of interest
are complete. The rest of the atoms of the cell must remain intact. Note that
the input atoms are transformed and are the same as are present in the
output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>labels</strong> (<em>int or list of ints</em>) – The number of the atoms from which the molecules are generated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>new_mol</strong> (<em>Mol object</em>) – The now complete molecule</li>
<li><strong>new_cell</strong> (<em>Mol object</em>) – The cell with the completed molecule</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.confined">
<code class="descname">confined</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.confined"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.confined" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all atoms to fit inside the primitive cell</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.count">
<code class="descname">count</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.dir_to_frac_pos">
<code class="descname">dir_to_frac_pos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.dir_to_frac_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.dir_to_frac_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all atoms to fractional coordinates</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.empty_mol">
<code class="descname">empty_mol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.empty_mol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.empty_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an empty mol with the same properties</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.es_pot">
<code class="descname">es_pot</code><span class="sig-paren">(</span><em>position</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.es_pot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.es_pot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the electorstatic potential generated by this Mol</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>position</strong> (<em>3x1 np array</em>) – The point at which the potential should be evaluated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>tot_pot</strong> – The total potential</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.extend">
<code class="descname">extend</code><span class="sig-paren">(</span><em>other_mol</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.extend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.extend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.frac_to_dir_pos">
<code class="descname">frac_to_dir_pos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.frac_to_dir_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.frac_to_dir_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all atoms to direct coordinates</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.insert">
<code class="descname">insert</code><span class="sig-paren">(</span><em>i</em>, <em>element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.insert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.make_cluster">
<code class="descname">make_cluster</code><span class="sig-paren">(</span><em>clust_rad</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.make_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.make_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a cluster of molecules from a primitive cell</p>
<p>This first makes a supercell of the correct size which will contain with
one additional buffer shell. Then the sphere is generated from this new
supercell by connectivity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>clust_rad</strong> (<em>float</em>) – Radius defining a sphere. All molecules with atoms in the sphere are
to be grabbed</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>cluster</strong> – Spherical cluster of molecules from their crystal positions</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Mol object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.per_bonded">
<code class="descname">per_bonded</code><span class="sig-paren">(</span><em>atom_a</em>, <em>atom_b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.per_bonded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.per_bonded" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if atom_a is bonded to atom_b given lattice conditions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_a, atom_b</strong> (<em>Atom objects</em>) – The atoms to be compared</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>bonded_bool</strong> – True if the atoms are bonded and False if not</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.per_select">
<code class="descname">per_select</code><span class="sig-paren">(</span><em>labels</em>, <em>old_pos=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.per_select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.per_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Select a molecule out of a Mol in a periodic system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>labels</strong> (<em>int or list of ints</em>) – The number of the atoms from which the molecules are generated</li>
<li><strong>old_pos</strong> (<em>bool</em>) – Option to print the selected molecule at its original coordinates</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>selected_img</strong> (<em>Mol object</em>) – The atoms belonging to the molecule which is selected with certain
atoms translated so that the molecule is fully connected without
periodic boundaries</li>
<li><strong>selected_old</strong> (<em>Mol object (optional)</em>) – The atoms belonging to the molecule which is selected before
translations</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><em>i=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.pop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.pop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.populate">
<code class="descname">populate</code><span class="sig-paren">(</span><em>reference_mol</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.populate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.populate" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign charges to the Mol by comparing to the connectivity of a
reference</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>reference_mol</strong> (<em>Mol object</em>) – Charged molecule or cell</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.raw_assign_charges">
<code class="descname">raw_assign_charges</code><span class="sig-paren">(</span><em>charges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.raw_assign_charges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.raw_assign_charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign the charges from an array-like to the atoms</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.remove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.remove_duplicates">
<code class="descname">remove_duplicates</code><span class="sig-paren">(</span><em>thresh=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.remove_duplicates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.remove_duplicates" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the duplicate atoms</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.segregate">
<code class="descname">segregate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.segregate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.segregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate current Mol in a list of Mols of different molecules</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.select">
<code class="descname">select</code><span class="sig-paren">(</span><em>labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.select" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a molecule out of the current Mol.</p>
<p>The function returns a new Mol of selected atoms atoms. The selection is
done by measuring by how much adjacent vdw spheres overlap. The returned
Mol’s attributes are new objects obtained via a deep copy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>label</strong> (<em>int or list of ints</em>) – The number of the atoms from which the molecules are generated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>selected</strong> – The selected molecule</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Mol object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.set_bonding">
<code class="descname">set_bonding</code><span class="sig-paren">(</span><em>bonding='dis'</em>, <em>thresh=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.set_bonding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.set_bonding" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the type of bonding detection used in this Mol</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bonding</strong> (<em>string ‘dist, ‘cov’ or ‘vdw’</em>) – The method for detecting bonding in this molecule.
‘dis’ : distance between atoms &lt; threshold
‘cov’ : distance - (cov radius of atom a + of atom b) &lt; threshold
‘vdw’ : distance - (vwd radius of atom a + of atom b) &lt; threshold</li>
<li><strong>thresh</strong> (<em>float, optional</em>) – Threshold for the detection. If None, use defaults:
‘dis’ -&gt; 1.8
‘cov’ -&gt; 0.2
‘vdw’ -&gt; -0.3</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.supercell">
<code class="descname">supercell</code><span class="sig-paren">(</span><em>trans</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.supercell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a supercell of I x J x K</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trans</strong> (<em>numpy array of length 3</em>) – Multiplications of the primitive cell</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>supercell</strong> – New supercell with adjusted lattice vectors</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Mol object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.trans_from_rad">
<code class="descname">trans_from_rad</code><span class="sig-paren">(</span><em>clust_rad</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.trans_from_rad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.trans_from_rad" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the translations necessary to encapsulate a sphere of given rad</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>clust_rad</strong> (<em>float</em>) – Radius defining a sphere</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>trans_count</strong> – The translations required for the unit cell to contain the sphere</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">3 x 1 numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>vector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate Mol by a vector</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vector</strong> (<em>3 x 1 numpy array</em>) – Translation vector</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.mol.Mol.write_xyz">
<code class="descname">write_xyz</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#Mol.write_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.Mol.write_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an xyz file of the Mol</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="fromage.utils.mol.try_ismol">
<code class="descclassname">fromage.utils.mol.</code><code class="descname">try_ismol</code><span class="sig-paren">(</span><em>to_test</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/mol.html#try_ismol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.mol.try_ismol" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if the argument is not a Mol object</p>
</dd></dl>

</div>
<div class="section" id="module-fromage.utils.per_table">
<span id="fromage-utils-per-table-module"></span><h2>5.1.1.4.7. fromage.utils.per_table module<a class="headerlink" href="#module-fromage.utils.per_table" title="Permalink to this headline">¶</a></h2>
<p>This module contains the information from the periodic table</p>
<dl class="function">
<dt id="fromage.utils.per_table.num_to_elem">
<code class="descclassname">fromage.utils.per_table.</code><code class="descname">num_to_elem</code><span class="sig-paren">(</span><em>num</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/per_table.html#num_to_elem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.per_table.num_to_elem" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the element symbol according to input atomic number</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>num</strong> (<em>int</em>) – Atomic number of the element</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-fromage.utils.volume">
<span id="fromage-utils-volume-module"></span><h2>5.1.1.4.8. fromage.utils.volume module<a class="headerlink" href="#module-fromage.utils.volume" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fromage.utils.volume.CubeGrid">
<em class="property">class </em><code class="descclassname">fromage.utils.volume.</code><code class="descname">CubeGrid</code><span class="sig-paren">(</span><em>vectors=array([[0., 0., 0.],        [0., 0., 0.],        [0., 0., 0.]]), x_num=1, y_num=1, z_num=1, origin=array([0., 0., 0.])</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A grid of voxels with attached values for each one</p>
<p>This objects contains the information present in a cube file minus the
atoms inside of it. Its main component is the self.grid but it contains
additional information which would be compuationally costly to extract
from the grid: the origin, the lattice vectors, the grid spacing. This
oject is delicate to use because in order to be writeable as a cube file,
the self.grid must a) be ordered and b) be on points of the grid. Therefore
not any translation of the grid will do. Here are provided functions which
break these rules along with ones which repair them. self.confine_sort is
therefore important to use on objects which will later be printed</p>
<dl class="attribute">
<dt id="fromage.utils.volume.CubeGrid.vectors">
<code class="descname">vectors</code><a class="headerlink" href="#fromage.utils.volume.CubeGrid.vectors" title="Permalink to this definition">¶</a></dt>
<dd><p><em>3x3 numpy array</em> – The three vectors defining the shape of one voxel in Angstrom</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">x_num, y_num, z_num</code></dt>
<dd><p><em>ints</em> – Length of the parallelepiped in units of voxels</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.volume.CubeGrid.origin">
<code class="descname">origin</code><a class="headerlink" href="#fromage.utils.volume.CubeGrid.origin" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy array of length 3</em> – Origin of the parallelepiped in Angstrom</p>
</dd></dl>

<dl class="attribute">
<dt id="fromage.utils.volume.CubeGrid.grid">
<code class="descname">grid</code><a class="headerlink" href="#fromage.utils.volume.CubeGrid.grid" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy array of x_num * y_num * z_num * x 4 dimension</em> – This determines a value and position at each point in space which is
the origin of a voxel. The format is [[x1,y1,z1,val],[x1,y1,z2,val],…]</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.add_grid">
<code class="descname">add_grid</code><span class="sig-paren">(</span><em>in_grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.add_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.add_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the results of another grid to the current grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>in_grid</strong> (<em>numpy N x 4 array</em>) – Same dimensions as self.grid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.centered_quad">
<code class="descname">centered_quad</code><span class="sig-paren">(</span><em>trans_vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.centered_quad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.centered_quad" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a 4x4x4 supercell centered at the origin after inplace translate</p>
<p>The point is to have a large grid which encloses a specific point of the
original grid. This way we can center a molecule (or several) at the
origin and sample as much as we want without risking hitting the
supercell walls</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trans_vec</strong> (<em>3x1 numpy array</em>) – The vector by which to translate inplace. The point which was
originally at trans_vec ends up at the origin</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.confine_sort">
<code class="descname">confine_sort</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.confine_sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.confine_sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Confine grid points in the enclosing box in the correct order</p>
<p>The enclosing box has origin in self.origin and bounding vectors
self.get_enclosing_vectors().</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.confine_unordered">
<code class="descname">confine_unordered</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.confine_unordered"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.confine_unordered" title="Permalink to this definition">¶</a></dt>
<dd><p>Confine grid points in the enclosing box but lose the correct order</p>
<p>This means that the grid is no longer ordered or on grid points defined
by the voxel spacing of the CubeGrid.</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.dir_to_frac_pos">
<code class="descname">dir_to_frac_pos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.dir_to_frac_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.dir_to_frac_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all grid points to fractional coordinates</p>
<p>This breaks the assumption that the grid is in real space. Therefore
this function is to be used with care</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.expand">
<code class="descname">expand</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.expand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.expand" title="Permalink to this definition">¶</a></dt>
<dd><p>BROKEN! Expand the grid so that the new grid has 8 times the volume</p>
<p>The original grid has the origin at 0,0,0 so we add grids at origins:
-a, 0, 0
0,-b, 0
0, 0,-c
-a,-b, 0
-a, 0,-c
0,-b,-c
-a,-b,-c</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.frac_to_dir_pos">
<code class="descname">frac_to_dir_pos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.frac_to_dir_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.frac_to_dir_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Move all grid points to direct coordinates</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.get_enclosing_vectors">
<code class="descname">get_enclosing_vectors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.get_enclosing_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.get_enclosing_vectors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.grid_from_point">
<code class="descname">grid_from_point</code><span class="sig-paren">(</span><em>x, y, z, res=10, box=array([[20.,  0.,  0.],        [ 0., 20.,  0.],        [ 0.,  0., 20.]])</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.grid_from_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.grid_from_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a grid from its centre, box dimension, and resolution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x, y, z</strong> (<em>floats</em>) – Centre of the grid</li>
<li><strong>res</strong> (<em>int</em>) – number of voxels per side of the box</li>
<li><strong>box</strong> (<em>3x3 numpy array</em>) – The three vectors defining the bounding box for the parallelepiped</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.out_cube">
<code class="descname">out_cube</code><span class="sig-paren">(</span><em>file_name</em>, <em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.out_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.out_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a cube file with the current state of the grid</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.proximity">
<code class="descname">proximity</code><span class="sig-paren">(</span><em>mol</em>, <em>rest</em>, <em>scaled=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.proximity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.proximity" title="Permalink to this definition">¶</a></dt>
<dd><p>Give each point in the grid a value of 1 if it is closest to the molecule</p>
<p>As a side effect, the origin is translated by half a voxel so that the
centre of each voxel corresponds to its value as opposed to the origin of
each voxel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mol</strong> (<em>list of Atom objects</em>) – The central molecule which we want to enclose in the grid</li>
<li><strong>rest</strong> (<em>list of Atom objects</em>) – The rest of the atoms</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.set_grid_coord">
<code class="descname">set_grid_coord</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.set_grid_coord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.set_grid_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the coordinates of the voxel origins on the grid</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.sort_adjust_frac_pos">
<code class="descname">sort_adjust_frac_pos</code><span class="sig-paren">(</span><em>sorting=True</em>, <em>rounding=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.sort_adjust_frac_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.sort_adjust_frac_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Put the fractional grid on fractional grid points and sort</p>
<p>The idea here is that in order to be able to use cube files, the grid
needs to be sorted in a specific way and the real space points must
coincide with grid points of the cube file, otherwise hard to diagnose
bugs happen. However in order to match grid points, slight translations
need to be done in the form of rounding, thus making the grid points
inaccurate for use in computation. Therefore this step is only to be
used when the end result is a cube file, not a grid for computation.</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.subtract_grid">
<code class="descname">subtract_grid</code><span class="sig-paren">(</span><em>in_grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.subtract_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.subtract_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the results of another grid from the current grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>in_grid</strong> (<em>numpy N x 4 array</em>) – Same dimensions as self.grid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.supergrid">
<code class="descname">supergrid</code><span class="sig-paren">(</span><em>trans</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.supergrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.supergrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a supercell cube out of the original cube grid with sorting</p>
<p>This is the function to call if the grid is then to be made into a cube
file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trans</strong> (<em>numpy array of length 3</em>) – Multiplications of the primitive cell</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.supergrid_unsorted">
<code class="descname">supergrid_unsorted</code><span class="sig-paren">(</span><em>trans</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.supergrid_unsorted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.supergrid_unsorted" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a supercell cube out of the original cube grid but no sorting</p>
<p>No sorting means that the values will not be in the correct order for
the cube file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trans</strong> (<em>numpy array of length 3</em>) – Multiplications of the primitive cell</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.translate_grid">
<code class="descname">translate_grid</code><span class="sig-paren">(</span><em>trans_vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.translate_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.translate_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate grid and origin by a numpy vector</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.translate_inplace">
<code class="descname">translate_inplace</code><span class="sig-paren">(</span><em>trans_vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.translate_inplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.translate_inplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate the cell and then confine it back to the enclosing box</p>
<p>This allows for the grid to move in the periodic cell without having to
change the origin</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>trans_vec</strong> (<em>3x1 numpy array</em>) – The vector by which to translate the grid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.unord_trans_inplace_grid">
<code class="descname">unord_trans_inplace_grid</code><span class="sig-paren">(</span><em>trans_vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.unord_trans_inplace_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.unord_trans_inplace_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unordered Cub after an inplace translation</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.vdw_vol">
<code class="descname">vdw_vol</code><span class="sig-paren">(</span><em>mol</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.vdw_vol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.vdw_vol" title="Permalink to this definition">¶</a></dt>
<dd><p>Give each point in the grid a value of 1 if it is inside the vdw radius of one of the atoms in the molecule</p>
</dd></dl>

<dl class="method">
<dt id="fromage.utils.volume.CubeGrid.volume">
<code class="descname">volume</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fromage/utils/volume.html#CubeGrid.volume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fromage.utils.volume.CubeGrid.volume" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fromage.utils">
<span id="module-contents"></span><h2>5.1.1.4.9. Module contents<a class="headerlink" href="#module-fromage.utils" title="Permalink to this headline">¶</a></h2>
<p>Utilities</p>
<p>API supporting the callable scripts in fromage</p>
<div class="section" id="modules">
<h3>5.1.1.4.9.1. Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>atom</dt>
<dd>Defines the Atom object which represents a single point in space with
a label, position and potentially a charge and connectivity</dd>
<dt>calc</dt>
<dd>Defines different Calc classes which run different electronic structure
programs</dd>
<dt>handle_atoms</dt>
<dd>Manipulates lists of Atom objects</dd>
<dt>per_table</dt>
<dd>Data from the periodic table</dd>
<dt>volume</dt>
<dd>Tools for the calculation of vdW spheres and Voronoi volumes in a
molecular crystal</dd>
</dl>
</div></blockquote>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="fromage.scripts.html" class="btn btn-neutral" title="5.1.1.3. fromage.scripts package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, Miguel Rivera, Michael Dommett, Rachel Crespo-Otero.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>