

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. Population analysis &mdash; fromage 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="fromage 1.0 documentation" href="index.html"/>
        <link rel="next" title="1. Interfaces" href="interfaces.html"/>
        <link rel="prev" title="3. Minimal Energy Conical Intersection optimisation" href="penalty_func.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> fromage
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. Program overview and install</a></li>
<li class="toctree-l1"><a class="reference internal" href="gloss.html">2. Essential glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">3. Tutorial for geometry optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">4. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">5. Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="zrefs.html">6. References</a></li>
</ul>
<p class="caption"><span class="caption-text">Theoretical background</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cluster_models.html">1. ONIOM cluster models</a></li>
<li class="toctree-l1"><a class="reference internal" href="ewald.html">2. Ewald point charge fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="penalty_func.html">3. Minimal Energy Conical Intersection optimisation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Population analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#methods">4.1. Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#crystal-or-molecular">4.2. Crystal or molecular</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Program documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">1. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">2. Input file description</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_manipulation.html">3. Structure manipulation in fromage</a></li>
<li class="toctree-l1"><a class="reference internal" href="script.html">4. Miscellaneous scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">5. fromage API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fromage</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>4. Population analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pop.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="population-analysis">
<span id="pop"></span><h1>4. Population analysis<a class="headerlink" href="#population-analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="methods">
<h2>4.1. Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<p>At the heart of of any point charge embedding scheme is the assumption that the
electrostatic potential generated by an atom can be approximated at a certain
distance by that of a point charge:</p>
<div class="math notranslate">
\[\sum_{i} \frac{q_i}{|\mathbf{r_i} - \mathbf{r}|} \approx \sum_{i} \int \frac{|\Psi_i(\mathbf{r'})|^2}{|\mathbf{r'} - \mathbf{r}|} \mathbf{dr'}\]</div>
<p>With <span class="math notranslate">\(\Psi_i(\mathbf{r})\)</span> being the wavefunction of atom <span class="math notranslate">\(i\)</span>,
<span class="math notranslate">\(q_i\)</span> its point charge value and <span class="math notranslate">\(\mathbf{r_i}\)</span> its position.
This approximation naturally breaks down at small <span class="math notranslate">\(|\mathbf{r_i} - \mathbf{r}|\)</span>
but by including ground state exchange via the <a class="reference internal" href="gloss.html#term-rl"><span class="xref std std-term">rl</span></a> term, this situation
is avoided.</p>
<p>The choice of <span class="math notranslate">\(q_i\)</span> is a non trivial matter. Considerable effort is spent
on parametrising forcefields for various applications, however in this case we
intend to use the point charges as one-electron terms in the <a class="reference internal" href="gloss.html#term-mh"><span class="xref std std-term">mh</span></a> and
<a class="reference internal" href="gloss.html#term-ml"><span class="xref std std-term">ml</span></a> Hamiltonians.</p>
<p>A first approximation can be the use of Mulliken charges. This has the
advantage of being trivial to compute in both the molecular and crystal
calculations. Unfortunately the well-known basis-set dependence of Mulliken
charge values can become a real problem.</p>
<p>Charge-density based methods represent the most direct way of fulfilling the
equation above. Hirshfeld and AIM charges<a class="reference internal" href="zrefs.html#henkelman2006" id="id1">[9]</a> fall in this category. RESP
are practically defined by the equation, albeit in a radial range around the
atoms.</p>
</div>
<div class="section" id="crystal-or-molecular">
<h2>4.2. Crystal or molecular<a class="headerlink" href="#crystal-or-molecular" title="Permalink to this headline">¶</a></h2>
<p>The population analysis methods described above can be applied to periodic
crystal calculations or single molecule calculations. Using the crystal
calculation has the advantage of including an interacting charge distribution at
equilibrium.</p>
<p>On the other hand, charges from molecular calculations could be more judicious
since they can be matched to the level of theory of the molecular calculation
that they are embedding. In this way if the high level of theory is TD-DFT B3LYP
and the low level of theory is DFT PBE, the charges assigned to <a class="reference internal" href="gloss.html#term-mh"><span class="xref std std-term">mh</span></a> can
come from B3LYP and the ones to <a class="reference internal" href="gloss.html#term-ml"><span class="xref std std-term">ml</span></a> from PBE. This is particularly
important in order to most totally cancel out intersystem electrostatic
interactions from <a class="reference internal" href="gloss.html#term-rl"><span class="xref std std-term">rl</span></a>.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="interfaces.html" class="btn btn-neutral float-right" title="1. Interfaces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="penalty_func.html" class="btn btn-neutral" title="3. Minimal Energy Conical Intersection optimisation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, Miguel Rivera, Michael Dommett, Rachel Crespo-Otero.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>