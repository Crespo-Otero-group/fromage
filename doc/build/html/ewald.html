

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. Ewald point charge fitting &mdash; fromage 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="fromage 1.0 documentation" href="index.html"/>
        <link rel="next" title="3. Minimal Energy Conical Intersection optimisation" href="penalty_func.html"/>
        <link rel="prev" title="1. ONIOM cluster models" href="cluster_models.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> fromage
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. Program overview and install</a></li>
<li class="toctree-l1"><a class="reference internal" href="gloss.html">2. Essential glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">3. Tutorial for geometry optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">4. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">5. Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="zrefs.html">6. References</a></li>
</ul>
<p class="caption"><span class="caption-text">Theoretical background</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cluster_models.html">1. ONIOM cluster models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Ewald point charge fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="penalty_func.html">3. Minimal Energy Conical Intersection optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pop.html">4. Population analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Program documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">1. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">2. Input file description</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_manipulation.html">3. Structure manipulation in fromage</a></li>
<li class="toctree-l1"><a class="reference internal" href="script.html">4. Miscellaneous scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">5. fromage API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fromage</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>2. Ewald point charge fitting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ewald.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ewald-point-charge-fitting">
<h1>2. Ewald point charge fitting<a class="headerlink" href="#ewald-point-charge-fitting" title="Permalink to this headline">Â¶</a></h1>
<p>Traditional electrostatic embedding for cluster models truncates the terms of
the Madelung summation up to the range of the cluster. This can sometimes be ill
advised since the Madelung summation is known to be slowly and conditionally
convergent.<a class="reference internal" href="zrefs.html#kittel1986" id="id1">[12]</a></p>
<p>A fast convergent reformulation of the Madelung summation is the Ewald
summation, expressed as a sum of both real and reciprocal space terms:</p>
<div class="math notranslate">
\[V^{Ewald} ( \mathbf{r} ) = \sum_{\mathbf{L}s} q_s \frac{\mathrm{erfc}{}(\gamma|\mathbf{r} - \mathbf{L}
- \mathbf{R}_s|)} {|\mathbf{r} - \mathbf{L} - \mathbf{R}_s|}
+ \frac{4 \pi} {v_c}
\sum_{\bf{G}\neq 0} \frac{1}{G^2} e^{-G^2/4\gamma^2}
\Bigg{[}\sum_s q_s e^{i\mathbf{G}(\mathbf{r} - \mathbf{R}_s )}\Bigg{]}\]</div>
<p>Where <span class="math notranslate">\(\mathbf{L}\)</span> are the lattice translations, <span class="math notranslate">\(\mathrm{erfc}\)</span> is
the complementary error function, <span class="math notranslate">\(\gamma\)</span> is the arbitrary Ewald
constant, <span class="math notranslate">\(\mathbf{R}_s\)</span> the atomic sites in the unit cell, <span class="math notranslate">\(v_c\)</span>
the unit cell volume, <span class="math notranslate">\(\mathbf{G}\)</span> the reciprocal lattice translations and
<span class="math notranslate">\(q_s\)</span> the partial charge of the atoms in the unit cell.<a class="reference internal" href="zrefs.html#kantorovich2004" id="id2">[11]</a></p>
<p>To generate point charges fitted to an Ewald potential, <strong>fromage</strong> relies on
the program <code class="docutils literal notranslate"><span class="pre">Ewald</span></code>, developed by Klintenberg, Derenzo and Weber.<a class="reference internal" href="zrefs.html#klintenberg2000" id="id3">[13]</a><a class="reference internal" href="zrefs.html#derenzo2000" id="id4">[6]</a></p>
<p>In this program, an a supercell of point charges is generated. The Ewald
potential is computed in a central region and the points in the outer region are
fitted to reproduce said potential via direct summation. See citations above for
more details.</p>
<p>Ewald point charge embedding has successfully been used to describe excited
states in molecular crystals.<a class="reference internal" href="zrefs.html#dommett2017c" id="id5">[7]</a><a class="reference internal" href="zrefs.html#wilbraham2016a" id="id6">[21]</a><a class="reference internal" href="zrefs.html#presti2017" id="id7">[19]</a></p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="penalty_func.html" class="btn btn-neutral float-right" title="3. Minimal Energy Conical Intersection optimisation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cluster_models.html" class="btn btn-neutral" title="1. ONIOM cluster models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, Miguel Rivera, Michael Dommett, Rachel Crespo-Otero.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>